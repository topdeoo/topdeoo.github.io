---
author: virgil
email: mailto:virgiling7@gmail.com
create time: 星期日, 十月 27日 2024, 4:07:23 下午
modify time: 星期一, 十月 28日 2024, 1:50:27 下午
---

# 5-1

## _Q_

一台计算机有 64MB 的内存，每个字长为 4 个字节，那么在存储器中对每个字寻址需要多少位？

# _A_

考虑内存中能够存储下多少个字：$64 \times 1024^2 \text{Byte} = \frac{{64 \times 1024^2 }}{4} \text{Word} = 2^{6 + 20 - 2} = 2^{24}$

于是需要 $24$ 根地址线

# 5-2

## _Q_

如果屏幕有 24 行，每行 80 个字符，则需要多少字节的内存用于存储全屏的数据？如果系统使用 ASCII 码，每个 ASCII 码占一个字节。

## _A_

$1 \text{Byte} \times 24 \times 80 = 1920 \text{Byte}$

# 5-3

## _Q_

假设一台计算机有 16 个数据寄存器（R0-R15），1024 个字的存储空间以及 16 种不同的指令（如 add，subtract 等），那么，

1. 下面这条指令最少需要占多少位空间？
   `add M R2`
2. 如果数据和指令使用相同的字长，那么每个数据寄存器大小是多少？
3. 计算机中的指令寄存器和程序计数器的大小分别是多少？
4. 数据总线、地址总线和控制总线分别是多少位？

## _A_

1. 首先，指令的结构如下所示：

| opcode (? bit) | op1(? bit) | op2(? bit) |
| :------------: | :--------: | :--------: |

考虑 `add M R2` 这条指令，我们至少需要 $\log(16)$， $\log(1024)$，$\log(16)$ 之和的长度来实现，其中 $\log(16)$ 表示一共 $16$ 中操作码(op-code)，$M$ 为地址，由于存储空间最大为 $1024$ 个字，因此寻址的长度（也就是地址线有多少根）`op1` 为 $\log(1024)$ ，一共 $16$ 个数据寄存器，于是用 `op2` 以区分，长度为 $\log(16)$

于是答案为 $4+10+4 = 18$

2.  由于一条指令的长度为 $18$ 位，换而言之字长与位之间的关系如下： $1 \text{Word} = 18 \text{bit}$，数据寄存器的大小为数据存储单元的大小，因此也是 $18$ 位
3.  指令寄存器的大小至少为 $18$ 位，程序计数器的大小为寻址所需的位数，也就是 `op1`，$\log(1024) = 10$
4.  数据总线长度为表示单个数据所需的最大位数，这里显然是 $18$，地址总线即为程序计数器的大小，也就是 $10$，控制总线为 `opcode` 的宽度，即 $\log(16) = 4$

# 5-13

## _Q_

使用教材中的简单计算机指令集，按照题目要求编写执行下列计算的程序代码：
B $\leftarrow$ A+3
其中，A 和 3 是二进制补码格式的整数，用户输入 A 的值，B 的值显示在监视器上。
题目要求：将变量 A 先保存到 M40 单元，并进一步保存到寄存器 R0；键盘输入保存到寄存器 RF；结果先保存到 M41 中，再输出到显示器。
![image.png](https://virgil-civil-1311056353.cos.ap-shanghai.myqcloud.com/img/20241027203050.png)
![image.png](https://virgil-civil-1311056353.cos.ap-shanghai.myqcloud.com/img/20241027203057.png)

## _A_

```python title:"Answer for B = A + 3"
0x00 0x1FFE # 从键盘读取 A 到寄存器 RF
0x01 0x240F # 保存到内存 M40
0x02 0x1040 # 将 M40 的数据读取到 R0
0x03 0xA000 # INC M40
0x04 0xA000 # 同上
0x05 0xA000 # 同上
0x06 0x2410 # 将 R0 写入内存 M41
0x07 0x1F41 # 将 M41 的结果读取到 RF 上
0x08 0x2FFF # 将 RF 的结果发送到显示器
0x09 0x0000 # 停机
```

# 5-16

## _Q_

使用教材中的简单计算机指令集，按照题目要求为程序编写代码，该程序接收从键盘来的两个整数，如果第一个整数为 0，程序把第二个整数加 1；如果第一个整数是 1，程序把第二个整数减 1。第一个整数必须是 0 或 1，否则程序结束。程序显示加 1 或减 1 的结果。
题目要求：可以从键盘输入 0 并保存到寄存器 R0；第一个数保存在寄存器 R1 中，第二个数保存在寄存器 R2 中；通过将输入的第一个数与 R0 进行比较并使用跳转指令来实现加 1 或者减 1 操作，其中跳转指令需要给出正确的地址，本题规定第一条指令所在地址为 0x00 
![image.png](https://virgil-civil-1311056353.cos.ap-shanghai.myqcloud.com/img/20241027203137.png)

## _A_

```python title:"Answer"
0x00 0x9000 # R0 XOR R0 = 0，将其保存到 R0（将 R0 置为零）
0x01 0x11FE # 从键盘读取 A，保存到 R1
0x02 0x12FE # 从键盘读取 B，保存到 R2
0x03 0xD108 # 如果 R1 != R0（A！= 0） 跳转到 0x08 的位置
0x04 0xA200 # R2 = R2 + 1
0x05 0x2FF2 # 将 R2 的值发送到显示器上
0x06 0xA100 # R1 = R1 + 1
0x07 0xD10A # 如果 R1 != R0（A!=0），跳转到 0x0a 的位置
0x08 0xB200 # R2 = R2 - 1
0x09 0x2FF2 # 将 将 R2 的值发送到显示器上
0x0a 0x0000 # 停机
```
# 单元测试题

## 单选题

### 1

_Q_ : Which of the following is not contained in a CPU?下列哪一项不包含在 CPU 中? ( )
A. Instruction register 指令寄存器
B. Program counter 程序计数器器
C. Data register 数据寄存器
D. Memory cell 内存单元

_A_ : D

### 2

_Q_: 一个 64KB、字长为 1 字节的内存的地址空间的范围为(  )。
A. 0-32767
B. 0-65535
C. 0-32768
D. 0-65526

_A_: B, $0 \sim 64 * 1024 - 1 = 2^{16} - 1 = 0 \sim 65535$

### 3

_Q_: 计算机的字长是 64 位,那么数据总线的宽度/位数为(  )。
A. 8
B. 16
C. 32
D. 64

_A_: D, 数据总线宽度与字长的位数一致

### 4

_Q_: Which of the following is not an activity performed entirely within a CPU?以下哪一个活动不是完全在 CPU 内执行的?(  )
A. Fetch instructions 取指令
B. Perform Boolean operations 执行布尔运算
C. Perform arithmetic operations 执行算术运算
D. Move data between registers 在寄存器之间移动数据

_A_: A, 取指令需要从内存（或缓存）中取出需要执行的指令码，不是完全在 CPU 内执行的， B，C 都在 ALU 内执行，寄存器在 CPU 上，移动数据显然是在 CPU 内执行的

### 5

_Q_: Which of the following instructions does not fall in the category of arithmetic/logic instructions?下列哪项指令不属于算术/逻辑指令范畴?(  )
A. ROTATE
B. ADD
C. OR
D. JUMP

_A_: D, 指令类型有：算术和逻辑指令、分支指令、数据传送指令、MCU 控制指令，这里我们主要关注前三种，JUMP 属于分支指令，意味无条件跳转到某个地址

### 6

_Q_: 下列不属于计算机的三大组成部件的是(  )。
A. 中央处理单元
B. 主存储器
C. 输入/输出子系统
D. 主机

_A_: D，计算机三大组成部件为：CPU，存储器，输入输出设备

### 7

_Q_: 下列既属于输入设备又属于输出设备的是(  )
A. 硬盘
B. 键盘
C. 打印机
D. 显示器

_A_: A, 显然硬盘作为持久化设备，需要能够支持被电脑读写，从而进行数据的可持久化

### 8

_Q_: 下列哪种情况不会发生溢出？（  ）
A. 正数加负数
B. 正数减负数
C. 负数减正数
D. 正数加正数

_A_: A, 注意需要从补码的角度考虑，考虑 8 位的计算机系统，取正数 $a$ 为 0b01111111, 负数 $b$ 为 0b11111111，于是 $a -b$ 为 $0b 01111111 + 0b 00000001 = 0b 10000000 < 0$，于是 B 错误，C 只需取  $-a$ 与 $-b$ 即可证伪，D 我们考虑 $a + a$ 显然小于 $0$

### 9

_Q_: In which of the following locations is information most readily available for manipulation by the CPU?以下哪一个存储设备里的信息最容易被CPU访问和处理?(  )
A. Cache memory 缓存内存
B. Main memory 主存储器
C. Mass storage 大容量存储器
D. registers 寄存器

_A_: D，处理器层次结构图如下所示：

![image.png](https://virgil-civil-1311056353.cos.ap-shanghai.myqcloud.com/img/20241027194641.png)

### 10

_Q_: 有关教材中简单计算机说法不正确的是(  )
A. 控制总线宽度/位数为4位
B. 数据总线宽度/位数为16位
C. 指令长度为16位
D. 程序计数器PC的大小为16位

![ca3e50bf8aca4ff20a6717a562e09ce7.jpeg](https://virgil-civil-1311056353.cos.ap-shanghai.myqcloud.com/img/ca3e50bf8aca4ff20a6717a562e09ce7.jpeg)


_A_:  D，显然 PC 大小为 2 位

### 11

_Q_: 计算机使用I/O独立寻址访问外设，如果该计算机内存为1024 个字，如果每个外设控制器包括16个寄存器，那么计算机可以存取多少个外设控制器？（ ）
A. 1024
B. 64
C. 16
D. 8

_A_: 每控制一个外设，我们就需要对此外设自带的 $16$ 个寄存器做寻址，因此我们最多控制 $1024 / 16 = 64$ 个外设

### 12

_Q_: 计算机使用存储器映射寻址I/O设备，如果地址总线为10条（10位），内存为 1000 个字，每个外设控制器有4个寄存器，那么计算机可以访问多少个外设控制器？（ ）
A. 24
B. 6
C. 1024
D. 10

_A_: 由于存储器只能通过未被映射到内存的部分进行 I/O 设备的映射，于是未映射到内存的有 $2^{10} - 1000 = 24$ 字，每映射一个设备就需要占用 4 个字用来访问寄存器，于是可以访问 $24 / 4 = 6$ 个设备

### 13 (Delete)

_Q_: 要想把一个位串清零，通常使用（ ）运算。
A. AND
B. OR
C. NOT
D. XOR

_A_: A、D，通过与掩码 `0x00000000` 进行与运算即可，但也可以通过与自身异或将自己清零

### 14

_Q_: 下列不属于机器周期内执行的步骤的是(  )
A. 取指令
B. 译码
C. 编译
D. 执行
 
_A_: C，显然编译不是机器周期内执行的步骤，我们需要将源代码编译为机器码后，执行机器码后才进入机器周期

### 15

_Q_: 下表显示了计算机内存的一部分,按照教材中简单计算机的指令集合,机器从程序计数器00启动,则内存单元6e中的内容是( ).
address   content
00          156c      
01          166d
02          3056
03          26e0
04          0000
…             …
6c          0001
6d         1001
6e            ?
…             …

A. 1010
B.  1002
C.  1110
D.  1011

![image.png](https://virgil-civil-1311056353.cos.ap-shanghai.myqcloud.com/img/20241027203003.png)

_A_: A, 指令含义为:
1. R5 <- M[6c]
2. R6 <- M[6d]
3. R0 <- R5 + R6
4. M[6e] <- R0
于是结果为 1010

### 16

_Q_: 一台计算机有64MB(兆字节)内存,字长为8字节，需要(  )位来寻址内存中的任意一个字?
A. 24
B. 25
C. 23
D. 27

_A_: C，按照字寻址，计算如下：$\frac{{64 * 1024^2}}{8} = \frac{{2^{6+20}}}{2^3} = 2^{23}$，于是需要 $\log(2^{23}) = 23$ 位

### 17

_Q_: 系统断电后,信息(数据或程序)会丢失的是(  )
A. ROM只读存储器
B. PROM可编程只读存储器
C. EPROM紫外线擦除可编程只读存储器
D. RAM随机存取存储器

_A_: 显然为 D，名字中带有只读的均为断电不会丢失的存储器
