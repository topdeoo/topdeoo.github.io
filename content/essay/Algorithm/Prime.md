---
title: ç´ æ•°ç›¸å…³
description: è¿™é‡Œä»‹ç»ä¸€äº›å…³äºæ‰¾ç´ æ•°çš„æ–¹æ³•ï¼Œå¯èƒ½æ˜¯ç´ æ•°ç­›ï¼Œä¹Ÿå¯èƒ½æ˜¯å¿«é€Ÿåˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯ç´ æ•°
tags:
  - ç®—æ³•è®²ä¹‰
date: 2022-03-29
lastmod: 2024-12-15
draft: false
---

ç´ æ•°ç­›ï¼Œå°±æ˜¯åœ¨ä¸€ä¸ªç»™å®šçš„èŒƒå›´å†…ï¼ŒæŠŠç´ æ•°ä¸éç´ æ•°åŒºåˆ†å‡ºæ¥ã€‚

æˆ‘ä»¬çŸ¥é“ï¼Œåˆ¤æ–­ä¸€ä¸ªç´ æ•°æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨å®šä¹‰æ¥åˆ¤æ–­ï¼š

```cpp
bool is_prime(int n){
    for(int i = 2; i < n; i++){
        if(n % i == 0)
            return 0;
    }
    return 1;
}
```

æ˜¾ç„¶è¿™ç§ç®—æ³•æ˜¯ $O(n)$ çš„ï¼Œæ£€æŸ¥ä¸€ä¸ªç´ æ•°å°±éœ€è¦ $O(n)$ çš„æ—¶é—´ï¼Œé‚£ä¹ˆæ£€æŸ¥ $n$ ä¸ªç´ æ•°çš„å¤æ‚åº¦å°±æ˜¯ $O(n^2)$ï¼Œè¿™æ˜¾ç„¶æ˜¯æ— æ³•æ¥å—çš„ï¼ˆåœ¨ OI ä¸­ï¼‰ã€‚

äºæ˜¯æœ‰ä¸€ç§ç¨å¾®å¿«ä¸€äº›çš„æ–¹æ³•ï¼Œå¯ä»¥æŠŠåˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯ç´ æ•°çš„æ—¶é—´é™ä½åˆ° $O(\sqrt{n})$ ï¼Œè¿™ç§ç®—æ³•çš„æ­£ç¡®æ€§æ˜¯åŸºäºä¸€ä¸ªæ˜¾ç„¶çš„äº‹å®ï¼šè‹¥ $t = ab$ åˆ™æ˜¾ç„¶ $t = ba$ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦æ£€æŸ¥åˆ° $\sqrt{n}$ ï¼Œè‹¥ $\sqrt{n}$ ä¹‹å‰çš„æ‰€æœ‰æ•°ï¼ˆ $1$ é™¤å¤–ï¼‰éƒ½ä¸æ˜¯ $n$ çš„å› å­ï¼Œé‚£ä¹ˆ $n$ ä¸€å®šæ˜¯ç´ æ•°ï¼š

```cpp
bool is_prime(int x){
    for(int i = 2; i <= sqrt(n); i++){
        if(n % i == 0)
            return 0;
    }
    return 1;
}
```

ç„¶è€Œï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§ç»å…¸çš„ç´ æ•°ç­›ç®—æ³•ï¼Œæ‰€ä»¥ä½ å¯ä»¥å½“åšæˆ‘ä¸Šé¢åœ¨æ‰¯æ·¡

## åŸƒæ°ç­›

åŸƒæ°ç­›åŸºäºä¸€ä¸ªç®€å•çš„äº‹å®ï¼šè¦å¾—åˆ°è‡ªç„¶æ•° n ä»¥å†…çš„å…¨éƒ¨ç´ æ•°ï¼Œå¿…é¡»æŠŠä¸å¤§äºæ ¹å· n çš„æ‰€æœ‰ç´ æ•°çš„å€æ•°å‰”é™¤ï¼Œå‰©ä¸‹çš„å°±æ˜¯ç´ æ•°ã€‚

ä¹Ÿå°±æ˜¯ä» $1$ ~ $n$ ä¸­ä¾æ¬¡åˆ é™¤ $2$ çš„å€æ•°ï¼Œ $3$ çš„å€æ•°.....ä»è€Œå¾—åˆ°æ‰€æœ‰çš„ç´ æ•°ã€‚

```cpp
#define N 500

vector<bool> is_prime(N + 5, true);
vector<int> prime;
void Eratosthenes(int n) {
	for (int i = 2; i <= n; i++) {
		if (is_prime[i]) {
			prime.push_back(i);
			if ((long long)i * i <= n)
				for (int j = i * i; j <= n; j += i)
					is_prime[j] = 0;
		}
	}
}
```

### ç®—æ³•åˆ†æ

å‡è®¾æ¯æ¬¡å¯¹æ•°å­—çš„æ“ä½œéƒ½èŠ±è´¹ $1$ ä¸ªå•ä½æ—¶é—´ï¼Œæ˜¾ç„¶ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º

$$
T(n) = \sum_{p\le n}\frac{n}{p} = n \sum^{\pi(n)}_{k=1}\frac{1}{p_k}
$$

å…¶ä¸­ï¼Œ $p_k$ è¡¨ç¤ºç¬¬ $k$ å°çš„ç´ æ•°ï¼Œ$\pi(n)$ è¡¨ç¤ºå°äºç­‰äº $n$ çš„ç´ æ•°çš„ä¸ªæ•°

åˆæ ¹æ® `Mertens' theorems` ï¼š

$$
\exists B_1 \in \mathbf{R}
$$

$$
s.t.\quad n \sum^{\pi(n)}_{k=1}\frac{1}{p_k} = \log\log{n} + B_1 + O(\frac{1}{\log n})
$$

å› æ­¤ï¼ŒåŸƒæ°ç­›çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n\log\log{n})$ ã€‚æ¥ä¸‹æ¥è¯æ˜ `Mertens' theorems` çš„å¼±åŒ–ç‰ˆæœ¬ $\sum_{k\le \pi(n)}\frac{1}{p_k} = O(\log\log{n})$:

ç”±äº $\pi(n) = \Theta(\frac{n}{\log{n}})$ é‚£ä¹ˆç¬¬ n ä¸ªç´ æ•°çš„å¤§å°ä¸º $\Theta(n\log{n})$

äºæ˜¯

$$

\begin{aligned}
\sum^{\pi(n)}_{k=1}\frac{1}{p_k} &=O(\sum^{\pi(n)}_{k=2}\frac{1}{k\log{k}})\\
&=O(\int^{\pi(n)}_2\frac{dx}{x\log{x}})\\
&=O(\log\log{\pi(n)})
=O(\log\log n)
\end{aligned}
$$

äº‹å®ä¸Šï¼Œå¯ä»¥å°†æ¸è¿›å¤æ‚åº¦â€œé™â€åˆ° $O(n\log\log{\sqrt{n}})$ï¼ˆå› ä¸ºè¿™ä¸ªå¤æ‚åº¦æ¸è¿›æ—¶é—´å’Œä¸Šé¢æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥é™å­—ç”¨åŒå¼•å·å¼•èµ·æ¥äº†ï¼‰ï¼Œå®é™…åšæ³•æ˜¯ï¼š

```cpp
int n;
vector<bool> is_prime(n + 1, true);
is_prime[0] = is_prime[1] = false;
for (int i = 2; i * i <= n; i++) {
  if (is_prime[i]) {
    for (int j = i * i; j <= n; j += i)
        is_prime[j] = false;
  }
}
```

## æ¬§æ‹‰ç­›

æ¬§æ‹‰ç­›åˆå«åšçº¿æ€§ç­›ï¼Œä¹Ÿå°±æ˜¯è¿è¡Œæ—¶é—´ä¸º $O(n)$ çš„ç­›æ³•ã€‚

å›é¡¾åŸƒæ°ç­›æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¯¹ä¸€ä¸ªç›¸åŒçš„åˆæ•°ï¼Œäº‹å®ä¸Šæˆ‘ä»¬åˆ’å»äº†ä¸æ­¢ $1$ æ¬¡ï¼Œæ¯æ¬¡é‡åˆ°å®ƒçš„è´¨å› å­æ—¶ï¼Œæˆ‘ä»¬éƒ½å°†å…¶åˆ’å»äº†ï¼Œé‡å¤çš„åˆ å»æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå¦‚æœèƒ½è®©æ¯ä¸ªåˆæ•°éƒ½åªè¢«åˆ å»ä¸€æ¬¡ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°†æ—¶é—´å¤æ‚åº¦é™åˆ° $O(n)$ äº†ã€‚

```cpp
#define N 1e5 + 10;

bool vis[N];
vector<int> primes;
void init(int n){
    vis[0] = vis[1] = 0;
    for(int i = 2; i <= n; i++){
        if(!vis[i]){
            vis[i] = 1;
            primes.push_back(i);
        }
        for(auto &j : primes){
            if(i * j > n)break;
            vis[i * j] = 1;
            if(i % j == 0)break;
        }
    }
}
```

çº¿æ€§ç­›å¯ä»¥åšçš„äº‹è¿œä¸æ­¢ç­›å‡ºç´ æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨çº¿æ€§ç­›æ¥æ±‚æ¬§æ‹‰å‡½æ•°ï¼Œè«æ¯”ä¹Œæ–¯å‡½æ•°ï¼Œå› å­çš„ä¸ªæ•°ï¼Œçº¦æ•°å’Œç­‰ç­‰ã€‚

è¿™äº›å†…å®¹ä¼šæ…¢æ…¢è¡¥å……ï¼ˆå¤§æ¦‚ï¼‰

# ä¸€äº›ç´ æ€§æµ‹è¯•

**ç´ æ€§æµ‹è¯•**è¿™ç§æ–¹æ³•ä¸éœ€è¦å¯¹æ•°å­—è¿›è¡Œç´ æ•°åˆ†è§£ï¼Œå¯ä»¥ç›´æ¥æµ‹è¯•ä¸€ä¸ªæ•°æ˜¯å¦ä¸ºç´ æ•°ã€‚

ç´ æ€§æµ‹è¯•æœ‰ä¸¤ç§ï¼š

1. ç¡®å®šæ€§æµ‹è¯•ï¼šç»å¯¹ç¡®å®šä¸€ä¸ªæ•°æ˜¯å¦ä¸ºç´ æ•°ã€‚å¸¸è§ç¤ºä¾‹åŒ…æ‹¬ Lucas-Lehmer æµ‹è¯•å’Œæ¤­åœ†æ›²çº¿ç´ æ€§è¯æ˜ã€‚
2. æ¦‚ç‡æ€§æµ‹è¯•ï¼šé€šå¸¸æ¯”ç¡®å®šæ€§æµ‹è¯•å¿«å¾ˆå¤šï¼Œä½†æœ‰å¯èƒ½ï¼ˆå°½ç®¡æ¦‚ç‡å¾ˆå°ï¼‰é”™è¯¯åœ°å°†åˆæ•°è¯†åˆ«ä¸ºè´¨æ•°ï¼ˆå°½ç®¡åä¹‹åˆ™ä¸ä¼šï¼‰ã€‚å› æ­¤ï¼Œé€šè¿‡æ¦‚ç‡ç´ æ€§æµ‹è¯•çš„æ•°å­—è¢«ç§°ä¸º **å¯èƒ½ç´ æ•°**ï¼Œç›´åˆ°å®ƒä»¬çš„ç´ æ•°å¯ä»¥è¢«ç¡®å®šæ€§åœ°è¯æ˜ã€‚è€Œé€šè¿‡æµ‹è¯•ä½†å®é™…ä¸Šæ˜¯åˆæ•°çš„æ•°å­—åˆ™è¢«ç§°ä¸º **ä¼ªç´ æ•°**ã€‚æœ‰è®¸å¤šç‰¹å®šç±»å‹çš„ä¼ªç´ æ•°ï¼Œæœ€å¸¸è§çš„æ˜¯è´¹é©¬ä¼ªç´ æ•°ï¼Œå®ƒä»¬æ˜¯æ»¡è¶³è´¹é©¬å°å®šç†çš„åˆæ•°ã€‚

è¿™é‡Œåªä»‹ç»ä¸€ç§æˆ‘å¸¸ç”¨çš„æ–¹æ³•ã€‚

## Miller-Rabin ç´ æ€§æµ‹è¯•

### æ•°å­¦åŸç†

é¦–å…ˆä»‹ç»**è´¹é©¬å°å®šç†**ï¼š

$$
a^{p-1} \equiv 1(mod\;p)
$$

å…¶ä¸­$(a, p) = 1$ï¼Œå› æ­¤ç´ æ•°å¯¹ä»»æ„ä¸ç­‰äºå®ƒæœ¬èº«çš„æ•°éƒ½æ»¡è¶³ä¸Šè¿°åŒä½™å¼ã€‚

é‚£ä¹ˆæ˜¯ä¸æ˜¯ä¸€ä¸ªæ•° $p$ å¯¹ä»»æ„ $a$ éƒ½æ»¡è¶³è¿™ä¸ªåŒä½™å¼ï¼Œ$p$ å°±æ˜¯ä¸€ä¸ªç´ æ•°å‘¢ï¼Ÿå½“ç„¶æ˜¯å­˜åœ¨åä¾‹çš„ï¼Œè¿™ä¸ªåä¾‹å°±æ˜¯ **å¡è¿ˆå°”æ•°**ï¼Œè¿™é‡Œä¸å»ä»‹ç»å¡è¿ˆå°”æ•°ï¼Œå¯ä»¥è‡ªè¡Œç™¾åº¦ ğŸ˜

ä½†æ˜¯ç”¨è´¹é©¬å°å®šç†å»åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯ç´ æ•°ï¼Œåœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯æ­£ç¡®çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥å¤§æ¦‚ç‡ç›¸ä¿¡ä¸€ä¸ªæ•°æ˜¯ç´ æ•°ã€‚

è¿™å°±æ˜¯ `Miller-Rabin` ç®—æ³•çš„ç«‹è¶³ç‚¹ã€‚

ä½†æˆ‘ä»¬ä»éœ€è¦ä¸€æ ·å®šç†ï¼š**äºŒæ¬¡æ¢æµ‹å®šç†**

è‹¥ $p$ ä¸ºå¥‡ç´ æ•°ï¼Œåˆ™ $x^2 \equiv 1 (mod \, p)$ çš„è§£ä¸º $x\equiv 1(mod\ p)$ æˆ– $x\equiv p-1(mod\, p)$

ä¸å¦¨å°†è´¹é©¬å°å®šç†å’ŒäºŒæ¬¡æ¢æµ‹å®šç†ç»“åˆèµ·æ¥ä½¿ç”¨ï¼š

å°† $a^{n-1}\equiv 1(mod\ n)$ ä¸­çš„æŒ‡æ•° $n-1$ åˆ†è§£ä¸º $n-1=2^t*u$ ï¼Œåœ¨æ¯è½®æµ‹è¯•ä¸­å¯¹éšæœºå‡ºæ¥çš„ $a$ å…ˆæ±‚å‡º $a^u \mod n$ ï¼Œä¹‹åå¯¹è¿™ä¸ªå€¼æ‰§è¡Œæœ€å¤š $t$ æ¬¡å¹³æ–¹æ“ä½œï¼Œè‹¥å‘ç°éå¹³å‡¡å¹³æ–¹æ ¹æ—¶å³å¯åˆ¤æ–­å‡ºå…¶ä¸æ˜¯ç´ æ•°ï¼Œå¦åˆ™é€šè¿‡æ­¤è½®æµ‹è¯•ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(T\log^3 n)$ çº§åˆ«, å…¶ä¸­ $T$ ä¸ºæµ‹è¯•çš„æ¬¡æ•°ã€‚è‹¥ä½¿ç”¨ `FFT` ä¼˜åŒ–ï¼Œå¤æ‚åº¦å¯ä»¥é™åˆ° $O(T\log^2{n}\log\log{n}\log\log\log{n})$

ç”±äºæ­¤ç®—æ³•ä¸ºæ¦‚ç‡ç®—æ³•ï¼Œå› æ­¤æ˜¯å­˜åœ¨è¯¯åˆ¤çš„ï¼Œè¯¯åˆ¤çš„æ¦‚ç‡ä¸º $\frac{1}{4^T}$ï¼Œå› æ­¤å½“ T è¾ƒå¤§æ—¶å¯è§†ä¸ºå®Œå¤‡ç®—æ³•ï¼Œä½† $T$ ä¸èƒ½é€‰å¤ªå¤§ï¼Œå¦åˆ™ä¼šå½±å“åˆ¤æ–­çš„æ•ˆç‡ï¼Œå»ºè®®å¤§äºç­‰äº $8$ å³å¯ã€‚

### ä»£ç å®ç°

```cpp
typedef long long ll;

const ll MOD = 1e9 + 7;
ll qpow(ll a, ll n, ll mod) {
  ll res = 1;
  while (n) {
    if (n & 1) res = res * a % mod;
    a = a * a % mod;
    n >>= 1;
  }
  return res;
}

ll qmul(ll a, ll b, ll mod) {
  ll res = 0;
  while (b) {
    if (b & 1) res = (a + res) % mod;
    a = a * 2 % mod;
    b >>= 1;
  }
  return res;
}

bool Miller_Rabin(ll n) {
  if (n == 2) return true;
  if (!(n & 1) || n < 2) return false;
  ll s = 0, t = n - 1;
  while (!(t & 1)) {
    s++;
    t >>= 1;
  }
  for (int i = 0; i < 20; i++) {
    ll a = rand() % (n - 1) + 1;
    ll x = qpow(a, t, n);
    for (int j = 1; j <= s; j++) {
      ll test = qmul(x, x, n);
      if (test == 1 && x != 1 && x != n - 1) return false;
      x = test;
    }
    if (x != 1) return false;
  }
  return true;
}
```
